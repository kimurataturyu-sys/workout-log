<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workout Log</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>🏋️ Workout Log</h1>

  <section class="card">
    <h2>🚀 トレーニング開始</h2>
    <div class="row">
      <select id="presetSelect"></select>
      <button id="startSessionBtn" type="button">このプリセットで開始</button>
    </div>
    <div id="sessionInfo" class="card"></div>

    <div class="row" style="align-items:flex-end;">
      <div style="flex:1;">
        <div style="font-size:12px;opacity:0.8;">当日メニュー（タップで差替え）</div>
        <div id="sessionExercises" class="card"></div>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>➕ 記録</h2>
    <form id="logForm">
      <input type="date" id="date" required />
      <select id="workoutSelect" required></select>
      <select id="exerciseSelect" required></select>
      <select id="setNo" required></select>

      <input type="number" id="weight" placeholder="重量(kg)" required step="0.5" />
      <input type="number" id="reps" placeholder="回数" required />
      <input type="number" id="rir" placeholder="RIR（余力 0〜5）" />

      <div id="feedback" class="card"></div>

      <div class="row">
        <button type="submit">記録</button>
        <button id="undoBtn" type="button">↩ 直前の入力を取り消す</button>
      </div>
    </form>
  </section>

  <section class="card">
    <h2>📈 グラフ</h2>
    <div class="row">
      <select id="filterExercise"></select>

      <select id="chartMetric">
        <option value="e1rm">推定1RM</option>
        <option value="weight">重量</option>
        <option value="reps">回数</option>
        <option value="volume">ボリューム（重量×回数）</option>
      </select>

      <select id="chartMode">
        <option value="bySet">セット別</option>
        <option value="sum">セット合計</option>
        <option value="both">セット別＋合計</option>
      </select>
    </div>

    <canvas id="chart"></canvas>
  </section>

  <section class="card">
    <h2>🧩 プリセット管理</h2>

    <div class="row">
      <input id="presetName" placeholder="プリセット名（例：PUSH 基本）" style="flex:2;" />
      <select id="presetBaseWorkout" style="flex:1;">
        <option value="PUSH">PUSH</option>
        <option value="PULL">PULL</option>
        <option value="LEGS">LEGS</option>
      </select>
      <button id="createPresetBtn" type="button">新規作成</button>
    </div>

    <div class="row">
      <select id="managePresetSelect" style="flex:2;"></select>
      <button id="renamePresetBtn" type="button">名前変更</button>
      <button id="deletePresetBtn" type="button">削除</button>
    </div>

    <div class="row">
      <input id="newExerciseName" placeholder="種目名（例：ベンチプレス）" style="flex:2;" />
      <input id="newMin" type="number" placeholder="min回数" style="width:90px;" />
      <input id="newMax" type="number" placeholder="max回数" style="width:90px;" />
      <button id="addExerciseBtn" type="button">種目追加</button>
    </div>

    <div id="presetExercises" class="card"></div>
  </section>

  <div id="modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);padding:18px;">
    <div class="card" style="max-width:720px;margin:0 auto;">
      <h3>🔁 種目を差替え</h3>
      <div id="swapTitle" style="margin-bottom:8px;opacity:.9;"></div>
      <div class="row">
        <select id="swapToSelect" style="flex:1;"></select>
        <button id="swapConfirmBtn" type="button">差替える</button>
        <button id="swapCancelBtn" type="button">キャンセル</button>
      </div>
      <div style="font-size:12px;opacity:0.8;margin-top:8px;">
        ※差替えは「今日のメニュー」だけ変更。差替え履歴は次回以降の候補に残ります。
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
